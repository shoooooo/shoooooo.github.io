<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title> Final Project </title>
  <style>
  html, body {
    background-color: black;
    width : 100%;
    height :100%;
    margin : 0px;
    cursor: url('cursor.png'), pointer;
  }
  </style>

</head>
<body>		

	<div>
 <canvas id="c" width="1000" height="1000" 
   style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
 <canvas id="d" width="1000" height="1000" 
   style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
</div>



	<script>	

var a=100;
var t3 = Math.sqrt(3);
var X = 0;
var Y = 0;
var gX = 0;
var gY = 0;

function n2h(n, X, Y) {
  var text;
  if(n==1) {
    c2.fillStyle = '#f00';
    text="C";
  }
  else if(n==2) {
    c2.fillStyle = '#f70';
    X+=1.5*a;
    Y+=2.5*t3*a;
    text="C#";
  }
  else if(n==3) {
    c2.fillStyle = '#ff0';
    X+=3*a;
    Y+=t3*a;
    text="D";
  }
  else if(n==4) {
    c2.fillStyle = '#7f0';
    X+=0;
    Y+=1*t3*a;
    text="D#";
  }
  else if(n==5) {
    c2.fillStyle = '#0f0';
    X+=1.5*a;
    Y-=0.5*t3*a;
    text="E";
  }
  else if(n==6) {
    c2.fillStyle = '#0f7';
    X+=3*a;
    Y+=2*t3*a;
    text="F";
  }
  else if(n==7) {
    c2.fillStyle = '#0ff';
    X+=0;
    Y+=2*t3*a;
    text="F#";
  }
  else if(n==8) {
    c2.fillStyle = '#07f';
    X+=1.5*a;
    Y+=0.5*t3*a;
    text="G";
  }
  else if(n==9) {
    c2.fillStyle = '#00f';
    X+=3*a;
    Y-=t3*a;
    text="G#";
  }
  else if(n==10) {
    c2.fillStyle = '#70f';
    X+=0;
    Y+=3*t3*a;
    text="A";
  }
  else if(n==11) {
    c2.fillStyle = '#f0f';
    X+=1.5*a;
    Y+=1.5*t3*a;
    text="A#";
  }
  else if(n==12) {
    c2.fillStyle = '#f07';
    X+=3*a;
    Y+=0;
    text="B";
  }
  c2.globalAlpha=0.5
  c2.beginPath();
  c2.moveTo(X+a, Y);
  c2.lineTo(X+a/2, Y+a*t3/2);
  c2.lineTo(X-a/2, Y+a*t3/2);
  c2.lineTo(X-a, Y);
  c2.lineTo(X-a/2, Y-a*t3/2);
  c2.lineTo(X+a/2, Y-a*t3/2);
  c2.closePath();
  c2.fill();
  c2.globalAlpha=0.15;
  c2.fillStyle='#fff';
  c2.font = '40pt Calibri';
  c2.textAlign = 'center';
  c2.textBaseline = 'middle';
  c2.fillText(text, X, Y);

}

var c2 = document.getElementById('c').getContext('2d');
c2.canvas.width = window.innerWidth;
c2.canvas.height = window.innerHeight;

var dX=0;
var dY=0;
var dxc = 0;
while(true) {
  while(true) {
    for(var i=1; i<=12; i++) {
      n2h(i,dX,dY-1.5*dxc*t3*a);
    }
    dX+=4.5*a;
    dxc++;
    if(dX>window.innerWidth+100)
      break;

  }
  dY+=4*t3*a;
  dX=0;
  dxc=0;
  if(dY>window.innerHeight+100+t3*window.innerWidth/3)
    break;
}

var d2 = document.getElementById('d').getContext('2d');
d2.canvas.width = window.innerWidth;
d2.canvas.height = window.innerHeight;
d2.fillStyle = '#fff';
d2.globalAlpha=0.6;


(function() {
    document.onmousemove = handleMouseMove;
    function handleMouseMove(event) {
        var dot, eventDoc, doc, body, pageX, pageY;

        event = event || window.event; 

        if (event.pageX == null && event.clientX != null) {
            eventDoc = (event.target && event.target.ownerDocument) || document;
            doc = eventDoc.documentElement;
            body = eventDoc.body;

            event.pageX = event.clientX +
              (doc && doc.scrollLeft || body && body.scrollLeft || 0) -
              (doc && doc.clientLeft || body && body.clientLeft || 0);
            event.pageY = event.clientY +
              (doc && doc.scrollTop  || body && body.scrollTop  || 0) -
              (doc && doc.clientTop  || body && body.clientTop  || 0 );
        }

      

      d2.beginPath();
      d2.arc(event.pageX, event.pageY, 100, 0, 2 * Math.PI, false);
      d2.fillStyle = '#ffffff';
      
      d2.lineWidth = 5;
      d2.strokeStyle = '#999999';
      d2.clearRect(0, 0, window.innerWidth, window.innerHeight);
      d2.stroke();
      d2.fill();
      var sX = event.pageX;
      var offset = 0;
      while(true) {
        if(sX<4.5*a)
          break;
        else {
          sX-=4.5*a;
          offset ++;
        }
      }
      var sY = event.pageY+1.5*t3*a*offset;
      while(true) {
        if(sY<4*t3*a)
          break;
        else
          sY-=4*t3*a;

      }
      if(sY > 4*t3*a-t3*sX/3) {
        sY-=4*t3*a;

      }
      gX = sX;
      gY = sY;

      V1.gain.value = D2V(Dist(1,gX,gY));
      V2.gain.value = D2V(Dist(2,gX,gY));
      V3.gain.value = D2V(Dist(3,gX,gY));
      V4.gain.value = D2V(Dist(4,gX,gY));
      V5.gain.value = D2V(Dist(5,gX,gY));
      V6.gain.value = D2V(Dist(6,gX,gY));
      V7.gain.value = D2V(Dist(7,gX,gY));
      V8.gain.value = D2V(Dist(8,gX,gY));
      V9.gain.value = D2V(Dist(9,gX,gY));
      V10.gain.value = D2V(Dist(10,gX,gY));
      V11.gain.value = D2V(Dist(11,gX,gY));
      V12.gain.value = D2V(Dist(12,gX,gY));

    }
})();
var e2 = document.getElementById('d')
e2.addEventListener("mousedown", function (e) {
        OnButtonDown()
    }, false);
    e2.addEventListener("mouseup", function (e) {
        OnButtonUp()
    }, false);

var ac = new AudioContext();

var envel = ac.createGain();
envel.gain.value=0;

var N1_1 = ac.createOscillator();
N1_1.frequency.value = 261.626;
var V1_1 = ac.createGain();
V1_1.gain.value = sbell(N1_1.frequency.value);
var N1_2 = ac.createOscillator();
N1_2.frequency.value = 277.183;
var V1_2 = ac.createGain();
V1_2.gain.value = sbell(N1_2.frequency.value);
var N1_3 = ac.createOscillator();
N1_3.frequency.value = 293.665;
var V1_3 = ac.createGain();
V1_3.gain.value = sbell(N1_3.frequency.value);
var N1_4 = ac.createOscillator();
N1_4.frequency.value = 311.127;
var V1_4 = ac.createGain();
V1_4.gain.value = sbell(N1_4.frequency.value);
var N1_5 = ac.createOscillator();
N1_5.frequency.value = 329.628;
var V1_5 = ac.createGain();
V1_5.gain.value = sbell(N1_5.frequency.value);
var N1_6 = ac.createOscillator();
N1_6.frequency.value = 349.228;
var V1_6 = ac.createGain();
V1_6.gain.value = sbell(N1_6.frequency.value);
var N1_7 = ac.createOscillator();
N1_7.frequency.value = 369.994;
var V1_7 = ac.createGain();
V1_7.gain.value = sbell(N1_7.frequency.value);
var N1_8 = ac.createOscillator();
N1_8.frequency.value = 391.995;
var V1_8 = ac.createGain();
V1_8.gain.value = sbell(N1_8.frequency.value);
var N1_9 = ac.createOscillator();
N1_9.frequency.value = 415.305;
var V1_9 = ac.createGain();
V1_9.gain.value = sbell(N1_9.frequency.value);
var N1_10 = ac.createOscillator();
N1_10.frequency.value = 440;
var V1_10 = ac.createGain();
V1_10.gain.value = sbell(N1_10.frequency.value);
var N1_11 = ac.createOscillator();
N1_11.frequency.value = 466.164;
var V1_11 = ac.createGain();
V1_11.gain.value = sbell(N1_11.frequency.value);
var N1_12 = ac.createOscillator();
N1_12.frequency.value = 493.883;
var V1_12 = ac.createGain();
V1_12.gain.value = sbell(N1_12.frequency.value);

var N0_1 = ac.createOscillator();
N0_1.frequency.value = 261.626/2;
var V0_1 = ac.createGain();
V0_1.gain.value = sbell(N0_1.frequency.value);
var N0_2 = ac.createOscillator();
N0_2.frequency.value = 277.183/2;
var V0_2 = ac.createGain();
V0_2.gain.value = sbell(N0_2.frequency.value);
var N0_3 = ac.createOscillator();
N0_3.frequency.value = 293.665/2;
var V0_3 = ac.createGain();
V0_3.gain.value = sbell(N0_3.frequency.value);
var N0_4 = ac.createOscillator();
N0_4.frequency.value = 311.127/2;
var V0_4 = ac.createGain();
V0_4.gain.value = sbell(N0_4.frequency.value);
var N0_5 = ac.createOscillator();
N0_5.frequency.value = 329.628/2;
var V0_5 = ac.createGain();
V0_5.gain.value = sbell(N0_5.frequency.value);
var N0_6 = ac.createOscillator();
N0_6.frequency.value = 349.228/2;
var V0_6 = ac.createGain();
V0_6.gain.value = sbell(N0_6.frequency.value);
var N0_7 = ac.createOscillator();
N0_7.frequency.value = 369.994/2;
var V0_7 = ac.createGain();
V0_7.gain.value = sbell(N0_7.frequency.value);
var N0_8 = ac.createOscillator();
N0_8.frequency.value = 391.995/2;
var V0_8 = ac.createGain();
V0_8.gain.value = sbell(N0_8.frequency.value);
var N0_9 = ac.createOscillator();
N0_9.frequency.value = 415.305/2;
var V0_9 = ac.createGain();
V0_9.gain.value = sbell(N0_9.frequency.value);
var N0_10 = ac.createOscillator();
N0_10.frequency.value = 440/2;
var V0_10 = ac.createGain();
V0_10.gain.value = sbell(N0_10.frequency.value);
var N0_11 = ac.createOscillator();
N0_11.frequency.value = 466.164/2;
var V0_11 = ac.createGain();
V0_11.gain.value = sbell(N0_11.frequency.value);
var N0_12 = ac.createOscillator();
N0_12.frequency.value = 493.883/2;
var V0_12 = ac.createGain();
V0_12.gain.value = sbell(N0_12.frequency.value);

var N2_1 = ac.createOscillator();
N2_1.frequency.value = 261.626*2;
var V2_1 = ac.createGain();
V2_1.gain.value = sbell(N2_1.frequency.value);
var N2_2 = ac.createOscillator();
N2_2.frequency.value = 277.183*2;
var V2_2 = ac.createGain();
V2_2.gain.value = sbell(N2_2.frequency.value);
var N2_3 = ac.createOscillator();
N2_3.frequency.value = 293.665*2;
var V2_3 = ac.createGain();
V2_3.gain.value = sbell(N2_3.frequency.value);
var N2_4 = ac.createOscillator();
N2_4.frequency.value = 311.127*2;
var V2_4 = ac.createGain();
V2_4.gain.value = sbell(N2_4.frequency.value);
var N2_5 = ac.createOscillator();
N2_5.frequency.value = 329.628*2;
var V2_5 = ac.createGain();
V2_5.gain.value = sbell(N2_5.frequency.value);
var N2_6 = ac.createOscillator();
N2_6.frequency.value = 349.228*2;
var V2_6 = ac.createGain();
V2_6.gain.value = sbell(N2_6.frequency.value);
var N2_7 = ac.createOscillator();
N2_7.frequency.value = 369.994*2;
var V2_7 = ac.createGain();
V2_7.gain.value = sbell(N2_7.frequency.value);
var N2_8 = ac.createOscillator();
N2_8.frequency.value = 391.995*2;
var V2_8 = ac.createGain();
V2_8.gain.value = sbell(N2_8.frequency.value);
var N2_9 = ac.createOscillator();
N2_9.frequency.value = 415.305*2;
var V2_9 = ac.createGain();
V2_9.gain.value = sbell(N2_9.frequency.value);
var N2_10 = ac.createOscillator();
N2_10.frequency.value = 440*2;
var V2_10 = ac.createGain();
V2_10.gain.value = sbell(N2_10.frequency.value);
var N2_11 = ac.createOscillator();
N2_11.frequency.value = 466.164*2;
var V2_11 = ac.createGain();
V2_11.gain.value = sbell(N2_11.frequency.value);
var N2_12 = ac.createOscillator();
N2_12.frequency.value = 493.883*2;
var V2_12 = ac.createGain();
V2_12.gain.value = sbell(N2_12.frequency.value);

var N3_1 = ac.createOscillator();
N3_1.frequency.value = 261.626*4;
var V3_1 = ac.createGain();
V3_1.gain.value = sbell(N3_1.frequency.value);
var N3_2 = ac.createOscillator();
N3_2.frequency.value = 277.183*4;
var V3_2 = ac.createGain();
V3_2.gain.value = sbell(N3_2.frequency.value);
var N3_3 = ac.createOscillator();
N3_3.frequency.value = 293.665*4;
var V3_3 = ac.createGain();
V3_3.gain.value = sbell(N3_3.frequency.value);
var N3_4 = ac.createOscillator();
N3_4.frequency.value = 311.127*4;
var V3_4 = ac.createGain();
V3_4.gain.value = sbell(N3_4.frequency.value);
var N3_5 = ac.createOscillator();
N3_5.frequency.value = 329.628*4;
var V3_5 = ac.createGain();
V3_5.gain.value = sbell(N3_5.frequency.value);
var N3_6 = ac.createOscillator();
N3_6.frequency.value = 349.228*4;
var V3_6 = ac.createGain();
V3_6.gain.value = sbell(N3_6.frequency.value);
var N3_7 = ac.createOscillator();
N3_7.frequency.value = 369.994*4;
var V3_7 = ac.createGain();
V3_7.gain.value = sbell(N3_7.frequency.value);
var N3_8 = ac.createOscillator();
N3_8.frequency.value = 391.995*4;
var V3_8 = ac.createGain();
V3_8.gain.value = sbell(N3_8.frequency.value);
var N3_9 = ac.createOscillator();
N3_9.frequency.value = 415.305*4;
var V3_9 = ac.createGain();
V3_9.gain.value = sbell(N3_9.frequency.value);
var N3_10 = ac.createOscillator();
N3_10.frequency.value = 440*4;
var V3_10 = ac.createGain();
V3_10.gain.value = sbell(N3_10.frequency.value);
var N3_11 = ac.createOscillator();
N3_11.frequency.value = 466.164*4;
var V3_11 = ac.createGain();
V3_11.gain.value = sbell(N3_11.frequency.value);
var N3_12 = ac.createOscillator();
N3_12.frequency.value = 493.883*4;
var V3_12 = ac.createGain();
V3_12.gain.value = sbell(N3_12.frequency.value);

var V1 = ac.createGain();
var V2 = ac.createGain();
var V3 = ac.createGain();
var V4 = ac.createGain();
var V5 = ac.createGain();
var V6 = ac.createGain();
var V7 = ac.createGain();
var V8 = ac.createGain();
var V9 = ac.createGain();
var V10 = ac.createGain();
var V11 = ac.createGain();
var V12 = ac.createGain();

V1.gain.value = 0;
V2.gain.value = 0;
V3.gain.value = 0;
V4.gain.value = 0;
V5.gain.value = 0;
V6.gain.value = 0;
V7.gain.value = 0;
V8.gain.value = 0;
V9.gain.value = 0;
V10.gain.value = 0;
V11.gain.value = 0;
V12.gain.value = 0;


N1_1.connect(V1_1);
N1_2.connect(V1_2);
N1_3.connect(V1_3);
N1_4.connect(V1_4);
N1_5.connect(V1_5);
N1_6.connect(V1_6);
N1_7.connect(V1_7);
N1_8.connect(V1_8);
N1_9.connect(V1_9);
N1_10.connect(V1_10);
N1_11.connect(V1_11);
N1_12.connect(V1_12);

N0_1.connect(V0_1);
N0_2.connect(V0_2);
N0_3.connect(V0_3);
N0_4.connect(V0_4);
N0_5.connect(V0_5);
N0_6.connect(V0_6);
N0_7.connect(V0_7);
N0_8.connect(V0_8);
N0_9.connect(V0_9);
N0_10.connect(V0_10);
N0_11.connect(V0_11);
N0_12.connect(V0_12);

N2_1.connect(V2_1);
N2_2.connect(V2_2);
N2_3.connect(V2_3);
N2_4.connect(V2_4);
N2_5.connect(V2_5);
N2_6.connect(V2_6);
N2_7.connect(V2_7);
N2_8.connect(V2_8);
N2_9.connect(V2_9);
N2_10.connect(V2_10);
N2_11.connect(V2_11);
N2_12.connect(V2_12);

N3_1.connect(V3_1);
N3_2.connect(V3_2);
N3_3.connect(V3_3);
N3_4.connect(V3_4);
N3_5.connect(V3_5);
N3_6.connect(V3_6);
N3_7.connect(V3_7);
N3_8.connect(V3_8);
N3_9.connect(V3_9);
N3_10.connect(V3_10);
N3_11.connect(V3_11);
N3_12.connect(V3_12);

var clickDetector = ac.createGain();
clickDetector.gain.value = 0;

V1.connect(clickDetector);
V2.connect(clickDetector);
V3.connect(clickDetector);
V4.connect(clickDetector);
V5.connect(clickDetector);
V6.connect(clickDetector);
V7.connect(clickDetector);
V8.connect(clickDetector);
V9.connect(clickDetector);
V10.connect(clickDetector);
V11.connect(clickDetector);
V12.connect(clickDetector);

V1_1.connect(V1);
V1_2.connect(V2);
V1_3.connect(V3);
V1_4.connect(V4);
V1_5.connect(V5);
V1_6.connect(V6);
V1_7.connect(V7);
V1_8.connect(V8);
V1_9.connect(V9);
V1_10.connect(V10);
V1_11.connect(V11);
V1_12.connect(V12);

V0_1.connect(V1);
V0_2.connect(V2);
V0_3.connect(V3);
V0_4.connect(V4);
V0_5.connect(V5);
V0_6.connect(V6);
V0_7.connect(V7);
V0_8.connect(V8);
V0_9.connect(V9);
V0_10.connect(V10);
V0_11.connect(V11);
V0_12.connect(V12);

V2_1.connect(V1);
V2_2.connect(V2);
V2_3.connect(V3);
V2_4.connect(V4);
V2_5.connect(V5);
V2_6.connect(V6);
V2_7.connect(V7);
V2_8.connect(V8);
V2_9.connect(V9);
V2_10.connect(V10);
V2_11.connect(V11);
V2_12.connect(V12);

V3_1.connect(V1);
V3_2.connect(V2);
V3_3.connect(V3);
V3_4.connect(V4);
V3_5.connect(V5);
V3_6.connect(V6);
V3_7.connect(V7);
V3_8.connect(V8);
V3_9.connect(V9);
V3_10.connect(V10);
V3_11.connect(V11);
V3_12.connect(V12);

N1_1.start(0);
N1_2.start(0);
N1_3.start(0);
N1_4.start(0);
N1_5.start(0);
N1_6.start(0);
N1_7.start(0);
N1_8.start(0);
N1_9.start(0);
N1_10.start(0);
N1_11.start(0);
N1_12.start(0);

N0_1.start(0);
N0_2.start(0);
N0_3.start(0);
N0_4.start(0);
N0_5.start(0);
N0_6.start(0);
N0_7.start(0);
N0_8.start(0);
N0_9.start(0);
N0_10.start(0);
N0_11.start(0);
N0_12.start(0);

N2_1.start(0);
N2_2.start(0);
N2_3.start(0);
N2_4.start(0);
N2_5.start(0);
N2_6.start(0);
N2_7.start(0);
N2_8.start(0);
N2_9.start(0);
N2_10.start(0);
N2_11.start(0);
N2_12.start(0);

N3_1.start(0);
N3_2.start(0);
N3_3.start(0);
N3_4.start(0);
N3_5.start(0);
N3_6.start(0);
N3_7.start(0);
N3_8.start(0);
N3_9.start(0);
N3_10.start(0);
N3_11.start(0);
N3_12.start(0);


clickDetector.gain.value=1;
clickDetector.connect(envel);
envel.connect(ac.destination);

var downtime=Date.now();
var uptime =Date.now();
function OnButtonDown (button) {
    
    var env = envel.gain;
    var now = ac.currentTime;

    env.cancelScheduledValues(now);
    env.setValueAtTime(0, now);

  
    env.linearRampToValueAtTime(1.3, now + 0.010);
    env.exponentialRampToValueAtTime(1, now + 0.700);
}
function OnButtonUp (button) {

    var env = envel.gain;
    var now = ac.currentTime;
    env.cancelScheduledValues(now);
    var fr = env.value;
    env.setValueAtTime(fr,now);
     
    env.linearRampToValueAtTime(0, now + 0.1);
}
function Dist(n, X, Y) {
  var ret;
  if(n==1) {
    ret = Math.min(DH(X,Y,0,0),DH(X,Y,4.5*a,-1.5*t3*a),DH(X,Y,0,4*t3*a),DH(X,Y,4.5*a,2.5*t3*a));
  }
  else if (n==2) {
    ret = DH(X,Y,1.5*a,2.5*t3*a);
  }
  else if (n==3) {
    ret = DH(X,Y,3*a,t3*a);
  }
  else if (n==4) {
    ret = Math.min(DH(X,Y,0,t3*a),DH(X,Y,4.5*a,-0.5*t3*a));
  }
  else if (n==5) {
    ret = Math.min(DH(X,Y,1.5*a,-0.5*t3*a),DH(X,Y,1.5*a,3.5*t3*a));
  }
  else if (n==6) {
    ret = DH(X,Y,3*a,2*t3*a);
  }
  else if (n==7) {
    ret = Math.min(DH(X,Y,0,2*t3*a),DH(X,Y,4.5*a,0.5*t3*a));
  }
  else if (n==8) {
    ret = DH(X,Y,1.5*a,0.5*t3*a);
  }
  else if (n==9) {
    ret = Math.min(DH(X,Y,3*a,-t3*a),DH(X,Y,3*a,3*t3*a));
  }
  else if (n==10) {
    ret = Math.min(DH(X,Y,0,3*t3*a),DH(X,Y,4.5*a,1.5*t3*a));
  }
  else if (n==11) {
    ret = DH(X,Y,1.5*a,1.5*t3*a);
  }
  else if (n==12) {
    ret = DH(X,Y,3*a,0);
  }

  return ret;

}
function DH(x1, y1, x2, y2) {
  return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));

}
function D2V(d) {

  var ret = 150-d;
  if(ret<0) return 0;
  else return ret/150.0;

}
function sbell(inp) {
  var a1=130.8;
  var a2=1688;
  var l1=Math.log(a1);
  var l2=Math.log(a2);
  var lin=Math.log(inp);
  if(inp<a1)
    return 0;
  else if (inp>a2)
    return 0;
  else {
    return (0.5+0.5*Math.sin((lin-l1)*2*Math.PI/(l2-l1)-Math.PI/2))*1.5*a1*a1/inp/inp;

  }

}

	</script>
</body>
</html>


