<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title> Final Project </title>
  <style>
  body {
    background-color: black
  }
  </style>

</head>
<body>		

	<div>
 <canvas id="c" width="1000" height="1000" 
   style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
 <canvas id="d" width="1000" height="1000" 
   style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
</div>



	<script>	

var a=100;
var t3 = Math.sqrt(3);
var X = 0;
var Y = 0;
var gX = 0;
var gY = 0;

function n2h(n, X, Y) {
  var text;
  if(n==1) {
    c2.fillStyle = '#f00';
    text="C";
  }
  else if(n==2) {
    c2.fillStyle = '#f70';
    X+=1.5*a;
    Y+=2.5*t3*a;
    text="C#";
  }
  else if(n==3) {
    c2.fillStyle = '#ff0';
    X+=3*a;
    Y+=t3*a;
    text="D";
  }
  else if(n==4) {
    c2.fillStyle = '#7f0';
    X+=0;
    Y+=1*t3*a;
    text="D#";
  }
  else if(n==5) {
    c2.fillStyle = '#0f0';
    X+=1.5*a;
    Y-=0.5*t3*a;
    text="E";
  }
  else if(n==6) {
    c2.fillStyle = '#0f7';
    X+=3*a;
    Y+=2*t3*a;
    text="F";
  }
  else if(n==7) {
    c2.fillStyle = '#0ff';
    X+=0;
    Y+=2*t3*a;
    text="F#";
  }
  else if(n==8) {
    c2.fillStyle = '#07f';
    X+=1.5*a;
    Y+=0.5*t3*a;
    text="G";
  }
  else if(n==9) {
    c2.fillStyle = '#00f';
    X+=3*a;
    Y-=t3*a;
    text="G#";
  }
  else if(n==10) {
    c2.fillStyle = '#70f';
    X+=0;
    Y+=3*t3*a;
    text="A";
  }
  else if(n==11) {
    c2.fillStyle = '#f0f';
    X+=1.5*a;
    Y+=1.5*t3*a;
    text="A#";
  }
  else if(n==12) {
    c2.fillStyle = '#f07';
    X+=3*a;
    Y+=0;
    text="B";
  }
  c2.globalAlpha=0.5
  c2.beginPath();
  c2.moveTo(X+a, Y);
  c2.lineTo(X+a/2, Y+a*t3/2);
  c2.lineTo(X-a/2, Y+a*t3/2);
  c2.lineTo(X-a, Y);
  c2.lineTo(X-a/2, Y-a*t3/2);
  c2.lineTo(X+a/2, Y-a*t3/2);
  c2.closePath();
  c2.fill();
  c2.globalAlpha=0.15;
  c2.fillStyle='#fff';
  c2.font = '40pt Calibri';
  c2.textAlign = 'center';
  c2.textBaseline = 'middle';
  c2.fillText(text, X, Y);

}

var c2 = document.getElementById('c').getContext('2d');

for(var i=1; i<=12; i++) {
  n2h(i,0,0);
}
for(var i=1; i<=12; i++) {
  n2h(i,4.5*a,2.5*t3*a);
}
for(var i=1; i<=12; i++) {
  n2h(i,0,4*t3*a);
}
for(var i=1; i<=12; i++) {
  n2h(i,4.5*a,-1.5*t3*a);
}
for(var i=1; i<=12; i++) {
  n2h(i,4.5*a,6.5*t3*a);
}
for(var i=1; i<=12; i++) {
  n2h(i,9*a,-3*t3*a);
}
for(var i=1; i<=12; i++) {
  n2h(i,9*a,1*t3*a);
}
for(var i=1; i<=12; i++) {
  n2h(i,9*a,5*t3*a);
}


var d2 = document.getElementById('d').getContext('2d');
d2.fillStyle = '#fff';
d2.globalAlpha=0.6;

(function() {
    document.onmousemove = handleMouseMove;
    function handleMouseMove(event) {
        var dot, eventDoc, doc, body, pageX, pageY;

        event = event || window.event; // IE-ism

        // If pageX/Y aren't available and clientX/Y are,
        // calculate pageX/Y - logic taken from jQuery.
        // (This is to support old IE)
        if (event.pageX == null && event.clientX != null) {
            eventDoc = (event.target && event.target.ownerDocument) || document;
            doc = eventDoc.documentElement;
            body = eventDoc.body;

            event.pageX = event.clientX +
              (doc && doc.scrollLeft || body && body.scrollLeft || 0) -
              (doc && doc.clientLeft || body && body.clientLeft || 0);
            event.pageY = event.clientY +
              (doc && doc.scrollTop  || body && body.scrollTop  || 0) -
              (doc && doc.clientTop  || body && body.clientTop  || 0 );
        }

        // Use event.pageX / event.pageY here

      

      d2.beginPath();
      d2.arc(event.pageX, event.pageY, 100, 0, 2 * Math.PI, false);
      d2.fillStyle = '#ffffff';
      
      d2.lineWidth = 5;
      d2.strokeStyle = '#999999';
      d2.clearRect(0, 0, 1000, 1000);
      d2.stroke();
      d2.fill();
      var sX = event.pageX;
      var offset = 0;
      while(true) {
        if(sX<4.5*a)
          break;
        else {
          sX-=4.5*a;
          offset ++;
        }
      }
      var sY = event.pageY+1.5*t3*a*offset;
      while(true) {
        if(sY<4*t3*a)
          break;
        else
          sY-=4*t3*a;

      }
      if(sY > 4*t3*a-t3*sX/3) {
        sY-=4*t3*a;

      }
      gX = sX;
      gY = sY;
      //console.log('('+sX+','+sY+')');

      V1_1.gain.value = D2V(Dist(1,gX,gY));
      V1_2.gain.value = D2V(Dist(2,gX,gY));
      V1_3.gain.value = D2V(Dist(3,gX,gY));
      V1_4.gain.value = D2V(Dist(4,gX,gY));
      V1_5.gain.value = D2V(Dist(5,gX,gY));
      V1_6.gain.value = D2V(Dist(6,gX,gY));
      V1_7.gain.value = D2V(Dist(7,gX,gY));
      V1_8.gain.value = D2V(Dist(8,gX,gY));
      V1_9.gain.value = D2V(Dist(9,gX,gY));
      V1_10.gain.value = D2V(Dist(10,gX,gY));
      V1_11.gain.value = D2V(Dist(11,gX,gY));
      V1_12.gain.value = D2V(Dist(12,gX,gY));

    }
})();
var e2 = document.getElementById('d')
e2.addEventListener("mousedown", function (e) {
        OnButtonDown()
    }, false);
    e2.addEventListener("mouseup", function (e) {
        OnButtonUp()
    }, false);

var ac = new AudioContext(); // Create audio container


var N1_1 = ac.createOscillator();
N1_1.frequency.value = 261.626;
var V1_1 = ac.createGain();
V1_1.gain.value = 0;
var N1_2 = ac.createOscillator();
N1_2.frequency.value = 277.183;
var V1_2 = ac.createGain();
V1_2.gain.value = 0;
var N1_3 = ac.createOscillator();
N1_3.frequency.value = 293.665;
var V1_3 = ac.createGain();
V1_3.gain.value = 0;
var N1_4 = ac.createOscillator();
N1_4.frequency.value = 311.127;
var V1_4 = ac.createGain();
V1_4.gain.value = 0;
var N1_5 = ac.createOscillator();
N1_5.frequency.value = 329.628;
var V1_5 = ac.createGain();
V1_5.gain.value = 0;
var N1_6 = ac.createOscillator();
N1_6.frequency.value = 349.228;
var V1_6 = ac.createGain();
V1_6.gain.value = 0;
var N1_7 = ac.createOscillator();
N1_7.frequency.value = 369.994;
var V1_7 = ac.createGain();
V1_7.gain.value = 0;
var N1_8 = ac.createOscillator();
N1_8.frequency.value = 391.995;
var V1_8 = ac.createGain();
V1_8.gain.value = 0;
var N1_9 = ac.createOscillator();
N1_9.frequency.value = 415.305;
var V1_9 = ac.createGain();
V1_9.gain.value = 0;
var N1_10 = ac.createOscillator();
N1_10.frequency.value = 440;
var V1_10 = ac.createGain();
V1_10.gain.value = 0;
var N1_11 = ac.createOscillator();
N1_11.frequency.value = 466.164;
var V1_11 = ac.createGain();
V1_11.gain.value = 0;
var N1_12 = ac.createOscillator();
N1_12.frequency.value = 493.883;
var V1_12 = ac.createGain();
V1_12.gain.value = 0;

N1_1.connect(V1_1);
N1_2.connect(V1_2);
N1_3.connect(V1_3);
N1_4.connect(V1_4);
N1_5.connect(V1_5);
N1_6.connect(V1_6);
N1_7.connect(V1_7);
N1_8.connect(V1_8);
N1_9.connect(V1_9);
N1_10.connect(V1_10);
N1_11.connect(V1_11);
N1_12.connect(V1_12);

var clickDetector = ac.createGain();
clickDetector.gain.value = 0;

V1_1.connect(clickDetector);
V1_2.connect(clickDetector);
V1_3.connect(clickDetector);
V1_4.connect(clickDetector);
V1_5.connect(clickDetector);
V1_6.connect(clickDetector);
V1_7.connect(clickDetector);
V1_8.connect(clickDetector);
V1_9.connect(clickDetector);
V1_10.connect(clickDetector);
V1_11.connect(clickDetector);
V1_12.connect(clickDetector);
N1_1.start(0);
N1_2.start(0);
N1_3.start(0);
N1_4.start(0);
N1_5.start(0);
N1_6.start(0);
N1_7.start(0);
N1_8.start(0);
N1_9.start(0);
N1_10.start(0);
N1_11.start(0);
N1_12.start(0);



clickDetector.connect(ac.destination);



function OnButtonDown (button) {
  clickDetector.gain.value = 1;
}
function OnButtonUp (button) {

  clickDetector.gain.value = 0;
}
function Dist(n, X, Y) {
  var ret;
  if(n==1) {
    ret = Math.min(DH(X,Y,0,0),DH(X,Y,4.5*a,-1.5*t3*a),DH(X,Y,0,4*t3*a),DH(X,Y,4.5*a,2.5*t3*a));
  }
  else if (n==2) {
    ret = DH(X,Y,1.5*a,2.5*t3*a);
  }
  else if (n==3) {
    ret = DH(X,Y,3*a,t3*a);
  }
  else if (n==4) {
    ret = Math.min(DH(X,Y,0,t3*a),DH(X,Y,4.5*a,-0.5*t3*a));
  }
  else if (n==5) {
    ret = Math.min(DH(X,Y,1.5*a,-0.5*t3*a),DH(X,Y,1.5*a,3.5*t3*a));
  }
  else if (n==6) {
    ret = DH(X,Y,3*a,2*t3*a);
  }
  else if (n==7) {
    ret = Math.min(DH(X,Y,0,2*t3*a),DH(X,Y,4.5*a,0.5*t3*a));
  }
  else if (n==8) {
    ret = DH(X,Y,2*a,0.5*t3*a);
  }
  else if (n==9) {
    ret = Math.min(DH(X,Y,3*a,-t3*a),DH(X,Y,3*a,3*t3*a));
  }
  else if (n==10) {
    ret = Math.min(DH(X,Y,0,3*t3*a),DH(X,Y,4.5*a,1.5*t3*a));
  }
  else if (n==11) {
    ret = DH(X,Y,1.5*a,1.5*t3*a);
  }
  else if (n==12) {
    ret = DH(X,Y,3*a,0);
  }

  return ret;

}
function DH(x1, y1, x2, y2) {
  return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));

}
function D2V(d) {

  var ret = 150-d;
  if(ret<0) return 0;
  else return ret/150.0;

}

	</script>
</body>
</html>


